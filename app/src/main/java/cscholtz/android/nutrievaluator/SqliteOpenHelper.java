package cscholtz.android.nutrievaluator;

import android.content.Context;
import android.database.Cursor;
import android.database.sqlite.SQLiteDatabase;
import android.database.sqlite.SQLiteOpenHelper;

public class SqliteOpenHelper extends SQLiteOpenHelper {
    private String queryCreate1 = "CREATE TABLE EDADES (id_edad	TEXT, min INTEGER, max NUMERIC, PRIMARY KEY(id_edad));";
    private String queryInsert1 = "INSERT INTO EDADES VALUES ('e01',1,1.9),('e02',2,2.9),('e03',3,3.9),('e04',4,4.9),('e05',5,5.9),('e06',6,6.9),('e07',7,7.9),('e08',8,8.9),('e09',9,9.9),('e10',10,10.9),('e11',11,11.9), ('e12',12,12.9), ('e13',13,13.9),('e14',14,14.9),('e15',15,15.9),('e16',16,16.9),('e17',17,17.9),('e18',18,18.9),('e19',19,24.9),('e20',25,34.9),('e21',35,44.9),('e22',45,54.9),('e23',55,64.9),('e24',65,74.9)";
    private String queryCreate2 = "CREATE TABLE AMB_MUJERES ( id_edad TEXT, P5 INTEGER, P10 INTEGER, P25 INTEGER, P50 INTEGER, P75 INTEGER, P90 INTEGER, P95 INTEGER, PRIMARY KEY(id_edad), FOREIGN KEY(id_edad) REFERENCES EDADES(id_edad));";
    private String queryInsert2 = "INSERT INTO AMB_MUJERES VALUES ('e01',885,973,1084,1221,1378,1535,1621), ('e02',973,1029,1119,1269,1405,1595,1727), ('e03',1014,1133,1227,1396,1563,1690,1846), ('e04',1058,1171,1313,1475,1644,1832,1958), ('e05',1238,1301,1423,1598,1825,2012,2159), ('e06',1354,1414,1513,1683,1877,2182,2323), ('e07',1330,1441,1602,1815,2045,2332,2469), ('e08',1513,1566,1808,2034,2327,2657,2996), ('e09',1723,1788,1976,2227,2571,2987,3112), ('e10',1740,1784,2019,2296,2583,2873,3093), ('e11',1784,1987,2316,2612,3071,3739,3953), ('e12',2092,2182,2579,2904,3225,3655,3847), ('e13',2269,2426,2657,3130,3529,4081,4568), ('e14',2418,2562,2874,3220,3704,4294,4850), ('e15',2426,2518,2847,3248,3689,4123,4756), ('e16',2308,2567,2865,3248,3718,4353,4946), ('e17',2442,2674,2996,3336,3833,4552,5251), ('e18',2398,2538,2917,3243,3694,4461,4767), ('e19',2538,2728,3026,3406,3877,4439,4940), ('e20',2661,2826,3148,3573,4138,4906,5541), ('e21',2750,2948,3359,3783,4428,5240,5877), ('e22',2784,2956,3378,3858,4520,5373,5964), ('e23',2784,3063,3477,4045,4750,5632,6247), ('e24',2737,3018,3444,4019,4739,5566,6214);";
    private String queryCreate3 = "CREATE TABLE AMB_HOMBRES ( id_edad TEXT, P5 INTEGER, P10 INTEGER, P25 INTEGER, P50 INTEGER, P75 INTEGER, P90 INTEGER, P95 INTEGER, PRIMARY KEY(id_edad), FOREIGN KEY(id_edad) REFERENCES EDADES(id_edad));";
    private String queryInsert3 = "INSERT INTO AMB_HOMBRES VALUES ('e01',956,1014,1133,1278,1447,1644,1720), ('e02',973,1040,1190,1345,1557,1690,1787), ('e03',1095,1201,1357,1484,1618,1750,1853), ('e04',1207,1264,1408,1579,1747,1926,2008), ('e05',1298,1411,1550,1720,1884,2089,2285), ('e06',1360,1447,1605,1815,2056,2297,2493), ('e07',1497,1548,1808,2027,2246,2494,2886), ('e08',1550,1664,1895,2089,2296,2628,2788), ('e09',1811,1884,2067,2288,2657,3053,3257), ('e10',1930,2027,2182,2575,2903,3886,3882), ('e11',2016,2156,2382,2670,3022,3359,4226), ('e12',2216,2339,2649,3022,3496,3968,4640), ('e13',2363,2546,3044,3553,4081,4502,4794), ('e14',2830,3147,3586,3963,4575,5368,5530), ('e15',3138,3317,3788,4481,5334,5631,5900), ('e16',3625,4044,4352,4951,5753,6576,6980), ('e17',3998,4252,4777,5286,5950,6886,7726), ('e18',4070,4481,5066,5552,6374,7067,8355), ('e19',4508,4777,5274,5913,6660,7606,8200), ('e20',4694,4963,5541,6214,7067,7847,8436), ('e21',4844,5181,5740,6490,7265,8034,8488), ('e22',4546,4946,5589,6297,7142,7918,8458), ('e23',4422,4783,5381,6144,6919,7670,8149), ('e24',3973,4411,5031,5716,6432,7074,7453); ";
    private String queryCreate4 = "CREATE TABLE CMB_HOMBRES ( id_edad TEXT, P5 INTEGER, P10 INTEGER, P25 INTEGER, P50 INTEGER, P75 INTEGER, P90 INTEGER, P95 INTEGER, PRIMARY KEY(id_edad), FOREIGN KEY(id_edad) REFERENCES EDADES(id_edad));";
    private String queryInsert4 = "INSERT INTO CMB_HOMBRES VALUES ('e01',110,113,119,127,135,144,147), ('e02',111,114,122,130,140,146,150), ('e03',117,123,131,137,143,148,153), ('e04',123,126,133,141,148,156,159), ('e05',128,133,140,147,154,162,169), ('e06',131,135,142,151,161,170,177), ('e07',137,139,151,160,168,177,190), ('e08',140,145,154,162,170,182,187), ('e09',151,154,161,170,183,196,202), ('e10',156,160,166,180,191,209,221), ('e11',159,165,173,183,195,205,230), ('e12',167,171,182,195,210,223,241), ('e13',172,179,196,211,226,238,245), ('e14',189,199,212,223,240,260,264), ('e15',199,204,218,237,254,266,272), ('e16',213,225,234,249,269,287,296), ('e17',224,231,245,258,273,294,312), ('e18',226,237,252,264,283,298,324), ('e19',238,245,257,273,289,309,321), ('e20',243,250,264,279,298,314,326), ('e21',247,255,269,286,302,318,327), ('e22',239,249,265,281,300,315,326), ('e23',236,245,260,278,295,310,320), ('e24',223,233,251,268,284,298,306);";
    private String queryCreate5 = "CREATE TABLE CMB_MUJERES ( id_edad TEXT, P5 INTEGER, P10 INTEGER, P25 INTEGER, P50 INTEGER, P75 INTEGER, P90 INTEGER, P95 INTEGER, PRIMARY KEY(id_edad), FOREIGN KEY(id_edad) REFERENCES EDADES(id_edad));";
    private String queryInsert5 = "INSERT INTO CMB_MUJERES VALUES ('e01',105,111,117,124,132,139,143), ('e02',111,114,119,126,133,142,147), ('e03',113,119,124,132,140,146,152), ('e04',115,121,128,136,144,152,157), ('e05',125,128,134,142,151,159,165), ('e06',130,133,138,145,154,166,171), ('e07',129,135,142,151,160,171,176), ('e08',138,140,151,160,171,183,194), ('e09',147,150,158,167,180,194,198), ('e10',148,150,159,170,180,190,197), ('e11',150,158,171,181,196,217,223), ('e12',162,166,180,191,201,214,220), ('e13',169,175,183,198,211,226,240), ('e14',174,179,190,201,216,232,247), ('e15',175,178,189,202,215,228,244), ('e16',170,180,190,202,216,234,249), ('e17',175,183,194,205,221,239,257), ('e18',174,179,191,202,215,237,245), ('e19',179,185,195,207,221,236,249), ('e20',183,188,199,212,228,246,264), ('e21',186,192,205,218,236,257,272), ('e22',187,193,206,220,238,260,274), ('e23',187,196,209,225,244,266,280), ('e24',185,195,208,225,244,264,279);";
    private String queryCreate6 = "CREATE TABLE AGB_HOMBRES ( id_edad TEXT, P5 INTEGER, P10 INTEGER, P25 INTEGER, P50 INTEGER, P75 INTEGER, P90 INTEGER, P95 INTEGER, PRIMARY KEY(id_edad), FOREIGN KEY(id_edad) REFERENCES EDADES(id_edad));";
    private String queryInsert6 = "INSERT INTO AGB_HOMBRES VALUES ('e01',452,486,590,741,895,1036,1176), ('e02',434,504,578,737,871,1044,1148), ('e03',464,519,590,736,868,1071,1151), ('e04',428,494,598,722,859,989,1085), ('e05',446,488,582,713,914,1176,1299), ('e06',371,446,539,678,896,1115,1519), ('e07',423,473,574,758,1011,1393,1511), ('e08',410,460,588,725,1003,1248,1558), ('e09',485,527,635,859,1252,1864,2081), ('e10',523,543,738,982,1376,1906,2609), ('e11',536,595,754,1148,1710,2348,2574), ('e12',554,650,874,1172,1558,2536,3580), ('e13',475,570,812,1096,1702,2744,3322), ('e14',453,563,786,1082,1608,2746,3508), ('e15',521,595,690,931,1423,2434,3100), ('e16',542,593,844,1078,1746,2280,3041), ('e17',598,698,827,1096,1636,2407,2888), ('e18',560,665,860,1264,1947,3302,3928), ('e19',594,743,963,1406,2231,3098,3652), ('e20',675,831,1174,1752,2459,3246,3786), ('e21',703,851,1310,1792,2463,3098,3624), ('e22',749,922,1254,1741,2359,3245,3928), ('e23',658,839,1116,1645,2236,2976,3466), ('e24',573,753,1122,1621,2199,2876,3327);";
    private String queryCreate7 = "CREATE TABLE AGB_MUJERES ( id_edad TEXT, P5 INTEGER, P10 INTEGER, P25 INTEGER, P50 INTEGER, P75 INTEGER, P90 INTEGER, P95 INTEGER, PRIMARY KEY(id_edad), FOREIGN KEY(id_edad) REFERENCES EDADES(id_edad));";
    private String queryInsert7 = "INSERT INTO AGB_MUJERES VALUES ('e01',401,466,578,706,847,1022,1140), ('e02',469,526,642,747,894,1061,1173), ('e03',473,529,656,822,967,1106,1158), ('e04',490,541,654,766,907,1109,1236), ('e05',470,529,647,812,991,1330,1536), ('e06',464,508,638,827,1009,1263,1436), ('e07',491,560,706,920,1135,1407,1644), ('e08',527,634,769,1042,1383,1872,2482), ('e09',642,690,933,1219,1584,2171,2524), ('e10',616,702,842,1141,1608,2500,3005), ('e11',707,802,1015,1301,1942,2730,3690), ('e12',782,854,1090,1511,2056,2666,3369), ('e13',726,838,1219,1625,2374,3272,4150), ('e14',981,1043,1423,1818,2403,3250,3765), ('e15',839,1126,1396,1886,2544,3093,4195), ('e16',1126,1351,1663,2006,2598,3374,4236), ('e17',1042,1267,1463,2104,2977,3864,5159), ('e18',1003,1230,1616,2104,2617,3508,3733), ('e19',1046,1198,1596,2166,2959,4050,4896), ('e20',1173,1399,1841,2548,3512,4690,5560), ('e21',1336,1619,2158,2898,3932,5093,5847), ('e22',1459,1803,2447,3244,4229,5416,6140), ('e23',1345,1879,2520,3369,4360,5276,6152), ('e24',1363,1681,2266,3063,3943,4914,5530);";
    private String queryCreate8 = "CREATE TABLE PT_MUJERES ( id_edad TEXT, P5 INTEGER, P10 INTEGER, P25 INTEGER, P50 INTEGER, P75 INTEGER, P90 INTEGER, P95 INTEGER, PRIMARY KEY(id_edad), FOREIGN KEY(id_edad) REFERENCES EDADES(id_edad));";
    private String queryInsert8 = "INSERT INTO PT_MUJERES VALUES ('e01',6,7,8,10,12,14,16), ('e02',6,8,9,10,12,15,16), ('e03',7,8,9,11,12,14,15), ('e04',7,8,8,10,12,14,16), ('e05',6,7,8,10,12,15,18), ('e06',6,6,8,10,12,14,16), ('e07',6,7,9,11,13,16,18), ('e08',6,8,9,12,15,18,24), ('e09',8,8,10,13,16,20,22), ('e10',7,8,10,12,17,23,27), ('e11',7,8,10,13,18,24,28), ('e12',8,9,11,14,18,23,27), ('e13',8,8,12,15,21,26,30), ('e14',9,10,13,16,21,26,28), ('e15',8,10,12,17,21,25,32), ('e16',10,12,15,18,22,26,31), ('e17',10,12,13,19,24,30,37), ('e18',10,12,15,18,22,26,30), ('e19',10,11,14,18,24,30,34), ('e20',10,12,16,21,27,34,37), ('e21',12,14,18,23,29,35,38), ('e22',12,16,20,25,30,36,40), ('e23',12,16,20,25,31,36,38), ('e24',12,14,18,24,29,34,36);";
    private String queryCreate9 = "CREATE TABLE PT_HOMBRES ( id_edad TEXT, P5 INTEGER, P10 INTEGER, P25 INTEGER, P50 INTEGER, P75 INTEGER, P90 INTEGER, P95 INTEGER, PRIMARY KEY(id_edad), FOREIGN KEY(id_edad) REFERENCES EDADES(id_edad));";
    private String queryInsert9 = "INSERT INTO PT_HOMBRES VALUES ('e01',6,7,8,10,12,14,16), ('e02',6,7,8,10,12,14,15), ('e03',6,7,8,10,11,14,15), ('e04',6,6,8,9,11,12,14), ('e05',6,6,8,9,11,14,15), ('e06',5,6,7,8,10,13,16), ('e07',5,6,7,9,12,15,17), ('e08',5,6,7,8,10,13,16), ('e09',6,6,7,10,13,17,18), ('e10',6,6,8,10,14,18,21), ('e11',6,6,8,11,16,20,24), ('e12',6,6,8,11,14,22,28), ('e13',5,5,7,10,14,22,26), ('e14',4,5,7,9,14,21,24), ('e15',4,5,6,8,11,18,24), ('e16',4,5,6,8,12,16,22), ('e17',5,5,6,8,12,16,29), ('e18',4,5,6,9,13,20,24), ('e19',4,5,7,10,15,20,22), ('e20',5,6,8,12,16,20,24), ('e21',5,6,8,12,16,20,23), ('e22',6,6,8,12,15,20,25), ('e23',5,6,8,11,14,19,22), ('e24',4,6,8,11,15,19,22); ";


    public SqliteOpenHelper(Context context, String name, SQLiteDatabase.CursorFactory factory, int version) {
        super(context, name, factory, version);
    }

    @Override
    public void onCreate(SQLiteDatabase db) {
        db.execSQL(queryCreate1);
        db.execSQL(queryCreate2);
        db.execSQL(queryCreate3);
        db.execSQL(queryCreate4);
        db.execSQL(queryCreate5);
        db.execSQL(queryCreate6);
        db.execSQL(queryCreate7);
        db.execSQL(queryCreate8);
        db.execSQL(queryCreate9);
        db.execSQL(queryInsert1);
        db.execSQL(queryInsert2);
        db.execSQL(queryInsert3);
        db.execSQL(queryInsert4);
        db.execSQL(queryInsert5);
        db.execSQL(queryInsert6);
        db.execSQL(queryInsert7);
        db.execSQL(queryInsert8);
        db.execSQL(queryInsert9);
    }

    @Override
    public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {

    }

    public void abrir(){
        this.getWritableDatabase();
    }
    public  void cerrar(){
        this.close();
    }

    public String getIdEdad(int edad){
        SQLiteDatabase db = getReadableDatabase();
        Cursor cursor = db.rawQuery("SELECT id_edad FROM EDADES WHERE "+edad+" BETWEEN min AND max", null);
        cursor.moveToFirst();
        return cursor.getString(0);
    }

    public Cursor percentiles(String idEdad, String sexo,String medicion){
        String strSexo;
        if(sexo.equals("Masculino")){
            strSexo = "HOMBRES";
        }else{
            strSexo = "MUJERES";
        }
        SQLiteDatabase db = getReadableDatabase();
        return db.rawQuery("SELECT * FROM "+medicion+"_"+strSexo+" WHERE id_edad like '"+idEdad+"'", null);
    }

}
